define(["require","application"],function(n,e,r){"use strict";function t(t){function i(e,r){n(e,function(){function n(e){n.times=0|n.times,n.times++>10||(a=setTimeout(function(){n(e);var r=[];throw e.forEach(function(n){n.resolved||r.push(n.name)}),new Error("DETECTED INIT HUNG UP WITHIN 30 SECONDS.\nPlease check out following modules:\n\t"+r.join("\n\t"))},3e4))}var e=[],t=arguments.length,a=null;if(0==t)return r(e);l.apply(arguments).map(function(i,o,u){function s(){l.apply(arguments).forEach(function(n){n&&(e.push(n),u.forEach(function(e){n.name==e.name&&(e.resolved=!0)}))}),--t<1&&(a&&clearTimeout(a),r(e))}p(i.module)?(i.module(s),a||n(u)):(i.name=i.module.name,s(i.module))})})}function c(n,e){return s(e.modules||{},function(r,t){var i={language:r.language||{},script:g(r.script),templateUrl:g(r.template),extras:{dynamic:r.dynamic,safe:r.safe,deps:r.depends,path:t}};e.dir&&(i.script=a(e,i.script),i.templateUrl=a(e,i.templateUrl),s(i.language,function(n,r){i.language[r]=a(e,n)}),i.extras.path="/"+a(e,t)),i.script=u(i.script),s(i.language,function(n,e){i.language[e]=u("json!"+n)}),n.push(i)}),e.includes&&s(e.includes||[],function(e){n=n.concat(c([],e))}),n}function f(n,e){return n.extras.deps.forEach(function(n){var r=h.find(function(e){return e.extras.path===n&&e.extras.dynamic});r&&(o.progress("Application","prepare dependency module > "+n),e.push(r),f(r,e))}),e}var d=c([],t),m=[function(n){o.progress("Application","prepare system modules"),e.$$config(r.depends||{});var t=r.includes||[];s(t,function(n){o.progress("Application","prepare system module > "+n)}),i(t,n)},function(n){o.progress("Application","prepare user modules");var e=[];d.filter(function(n){return n.ready=!n.extras.dynamic}).forEach(function(n){o.progress("Application","prepare user module > "+n.extras.path),f(n,e).push(n)}),i(e=e.map(function(n){return n.extras.dynamic=!1,n.script}),n)}];s(d,function(n){n.extras.path===e.layout&&(e.layout=n,n.extras.layout=!0,n.extras.safe=!0,n.extras.dynamic=!1)});var h=d.filter(function(n){return!n.extras.layout&&!n.templateUrl});e.routes=d.filter(function(n){return!n.extras.layout&&n.templateUrl}),e.dependModules=f,function n(e){m.length?m.shift()(function(r){n(e.concat(r))}):(e=e.map(function(n){return o.progress("Application","bootstrap module > "+n.name),n.name}),angular.bootstrap(document,e,{strictDi:!0}),o.progress("Application","ready",!0))}([])}function a(n,e){return e&&"/"!=e[0]?i([n.dir,e].join("/")):e}function i(n){var e=[];return n.split("/").forEach(function(n){".."===n?e.pop():"."!==n&&e.push(n)}),e.join("/")}var o=e.uefi,u=e.$$cacheUrl,s=(angular.bootstrap,angular.forEach),c=angular.merge,l=Array.prototype.slice,p=angular.isFunction,f=angular.isArray,d=angular.isDefined,m=angular.isString,g=function(n){if(!n)return n;for(var r=/\$\{([a-zA-Z\.\-0-9/]+)\}/g,t=0;t<100;t++){var a=r.exec(n);if(!a)return n;var i=e[a[1]];if(!i||!m(i))throw new Error("CANNT RESOLVE VAR `"+a+"`");n=n.replace(r,i)}throw new Error("TO MANY LEVELS IN VAR RESOLVE.")};setTimeout(function(){o.progress("Application","loading"),n([u("json!lib/system/modules/configuration.json")],function(a){function o(n,e){return d(n)?n:e}var p,m={includes:[],dynamic:!1,safe:!1};r=a,function r(a,d){a.length&&(r.$remaining=0|r.$remaining,r.$remaining+=a.length,n(a.map(function(n){return u(g(0===n.indexOf("json!")?n:"json!"+n))}),function(){var n=l.apply(arguments);s(n,function(n,e){d.includes.push(n),n.dynamic=o(n.dynamic,o(d.dynamic,!0)),n.safe=o(n.safe,o(d.safe,!1)),s(n.modules,function(e){e.dynamic=o(e.dynamic,o(n.dynamic,!0)),e.safe=o(e.safe,o(n.safe,!1)),e.depends=e.depends||[]});var t=i(a[e]).split("/");if(t.pop(),n.dir=t.length?t.join("/"):"",n.includes&&f(n.includes)){var u=n.includes.map(function(n){return t.length?t.concat(n).join("/"):n});n.includes=[],r(u,n)}d===m?p=m.includes[0].environment||{}:c(p,n.environment||{})}),(r.$remaining-=n.length)||(m=m.includes[0],c(e,{name:"APPLICATION"},p),t(m))}))}(["application.json"],m)})})});