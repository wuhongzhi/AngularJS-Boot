define(["require","exports","application"],function(e,n,t){var o=angular.module("system.devices",["ng"]),r=t.$$cacheUrl,i=Array.prototype.slice,a=t.uefi,u={},c=function(){var e=a.native;if(e.mobile)return e.mobile.gui,{mobile:!0,desktop:!1,version:e.mobile.version};window.location.href;var n=e.desktop||{version:{major:-1,minor:-1}};return{mobile:!1,desktop:!!e.desktop,version:n.version}}();angular.extend(n,{name:o.name,module:function(n){var t=c.mobile?"mobile":c.desktop?"desktop":"browser";e([r("json!lib/system/etc/device.json")],function(r){e(r.depends[t],function(){i.apply(arguments).forEach(function(e){u[e.device]=e}),n(o)})})}}),o.run(["$rootScope",function(e){e.device=angular.extend(c,{support:function(e,n){return!(!e&&!n)&&(!!e&&!(!(e=u[e])||n&&-1===e.supports.indexOf(n)))}})}]).config(["$provide",function(e){a.progress("Application","setup system.devices"),e.decorator("$http",["$delegate","$q","$timeout",function(e,n,t){function o(){function o(e){c.reject(angular.extend({status:501,message:e},l))}var r=null,i=arguments[0];if(angular.isObject(i)&&i.url&&(r=/^device:\/\/(\w+)\??(.*)$/.exec(i.url))){var a=r[1],c=n.defer(),s=i.params||{},l={xhrStatus:"complete",statusText:"complete",config:i,headers:{"Content-Type":"application/json;charset=utf-8"}};return t(function(){try{a=u[a],angular.isFunction(a)?a.call(a,s,function(e){c.resolve(angular.extend({status:200,data:e},l))},o):o("No such device `"+r[1]+"`")}catch(e){o(e.message)}}),c.promise}return e.apply(e,arguments)}return function(e){angular.forEach(arguments,function(e){o[e]=function(n,t){return o(angular.extend({},t||{},{method:e,url:n}))}})}("get","delete","head","jsonp"),function(e){angular.forEach(arguments,function(e){o[e]=function(n,t,r){return o(angular.extend({},r||{},{method:e,url:n,data:t}))}})}("post","put","patch"),o}])}])});