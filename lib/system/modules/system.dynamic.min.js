define(["require","exports","application"],function(a,e,o){var t=e.module=angular.module("system.dynamic",["system.http","gui.language"]),n=Array.prototype.slice,r=o.uefi,s=o.components;t.config(function(){r.progress("Application","setup system.dynamics")}).run(["$rootScope","$location","$route","$injector",function(e,o,t,p){var i=e.$broadcast;e.$on("$locationChangeStart",function(c){function u(a){a.forEach(function(a){var e=s.find(function(e){return e.extras.path===a&&e.extras.dynamic});e&&(r.progress("Application","load dynamic module > "+a),m.scripts.push(e.script),m.components.push(e),u(e.extras.deps))})}var l=t.routes[o.path()];if(l&&!l.ready&&!l.inProgress&&!c.defaultPrevented){l.inProgress=!0,c.preventDefault();var d=n.apply(arguments),g=l.language[e.language.getLocale()];r.progress("Application","load dynamic module > "+l.extras.path);var m={scripts:[],components:[]};u(l.extras.deps),a(m.scripts.concat([l.script,g]),function(){var a=n.apply(arguments),t=a.pop();a=a.map(function(a){return r.progress("Application","setup module > "+a.module.name),a.module.name}),r.progress("Application","setup module > "+l.extras.path),p.loadNewModules(a),e.language.loadLanguage([[g,t]]),d[0]="$locationChangeSuccess",m.components.forEach(function(a){a.extras.dynamic=!1}),l.ready=!0,l.inProgress=!1,o.path(l.extras.path),i.apply(e,d)})}})}])});