define(["require","exports","application"],function(e,a,n){function r(a){var l=this.locale;t.dynamics=t.dynamics||{$$buf:{},put:function(e){e&&(e=e.substr(0,e.lastIndexOf("/")),this.$$buf[e]=!0)},has:function(e){return e=e.substr(0,e.lastIndexOf("/")),!!this.$$buf[e]}};var o=r.languages=r.languages||{},c=o[l]=o[l]||{},i=n.routes.concat(n.layout).filter(function(e){var a=e.language[l];return a&&!c[a]&&(!e.extras.dynamic||t.dynamics.has(a))}).map(function(e){return e.language[l]}),s="lib/angular.js/i18n/angular-locale_LOCALE.js";i.unshift(s.replace(/LOCALE/,l)),b&&b.$broadcast("$localeChangeStart",l),e(i,function(){for(var e=0;e<i.length;e++){var n=i[e];if(e)c[n]=!0,i[e]=[n,arguments[e]];else{var r=c[n]=c[n]||g(["ngLocale"]).get("$locale");i[e]=[s,arguments[e]],p.$locale&&p.$locale.id!==r.id&&v(p.$locale,r)}}t.bind({locale:l})(i),a&&a(u),b&&b.$broadcast("$localeChangeSuccess",l)})}function t(){var e=y[this.locale]=y[this.locale]||{};f($.apply(arguments),function(a){f(a,function(a){t.dynamics.put(a[0]),f(a[1],function(a,n){e[n.toLowerCase()]=a})})})}function l(e){if(e=(e||Modernizr.localstorage&&localStorage["system.locale"]||navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage||p.locale||"zh-cn").toLowerCase(),-1==p.locales.indexOf(e)&&(e="zh-cn"),-1!==p.locales.indexOf(e)&&Modernizr.localstorage)try{localStorage["system.locale"]=e}catch(e){}return e}function o(e){if(!e)return"";e=e.trim().toLowerCase();var a=(y[p.locale]||{})[e];if(!a)return"TODO: Translate `"+e+"` in `"+p.locale+"`";var n=$.call(arguments,1);return n.length?a.replace(/\{(\d+)\}/g,function(e,a){var r=n[0|a];return void 0!==r?r:e}):a}function c(e,a){var n=0;switch(a){case"gbk":case"gb18030":e=Array.from(e);for(i=0;i<e.length;i++){if((u=e[i].codePointAt(0))<128)n+=1;else{for(var r=m[a],t=!1,l=0;l<r.length;l+=2){var o=r[l],c=o+r[l+1];if(t=o<=u&&u<=c)break}if(t)n+=2;else{if(r!==m.gb18030)return-1;if(u>1587600)return-1;n+=4}}}break;case"utf8":e=Array.from(e);for(var i=0;i<e.length;i++){var u=e[i].codePointAt(0);if(u<128)n+=1;else if(u<2048)n+=2;else if(u<65536)n+=3;else{if(!(u<1114112))return-1;n+=4}}break;default:return-1}return n}function i(e){return parseInt(e,10)}var u=angular.module("gui.language",["ng"]),s=n.uefi,f=angular.forEach,g=angular.injector,d=angular.extend,v=angular.merge,$=Array.prototype.slice,y={},b=null,p={$locale:null,currency:n.currency||"Â¥",locales:n.locales||["zh-cn"],locale:n.locale},h=Number.isNaN||function(e){return e!=e};p.locale=l(),d(a,{name:u.name,module:r.bind({locale:p.locale})}),["locale","locales","currency"].forEach(function(e){delete n[e]}),u.config(["$provide",function(e){p.$locale||(s.progress("Application","setup gui.language"),e.decorator("currencyFilter",["$delegate",function(e){return d(function(){var a=$.apply(arguments);return a[1]&&"$system$"!==a[1]||(a[1]=p.currency),e.apply(e,a)},{$stateful:!0})}]),["date","number"].forEach(function(a){e.decorator(a+"Filter",["$delegate",function(e){return d(e,{$stateful:!0})}])}))}]).run(["$locale","$rootScope",function(e,a){p.$locale||(p.$locale=e,angular.extend(b=a,{language:{loadLanguage:t.bind(p),translate:o.bind({}),getLocale:function(){return p.locale},getLocales:function(){return[].concat(p.locales)},setLocale:function(e){e=l(e.toLowerCase()),r.bind({locale:e})(function(){p.locale=e})}}}))}]).directive("maxbytes",function(){return{restrict:"A",require:["?ngModel","^?ngModelOptions"],link:function(e,a,n,r){var t=r[0],l=r[1]&&r[1].$options.getOption("charset")||"utf8";if(t){var o=-1;n.$observe("maxbytes",function(e){var a=i(e)||0;o=h(a)?-1:a,t.$validate()}),t.$validators.maxbytes=function(e,a){if(o<0||t.$isEmpty(a))return!0;var n=c(a,l);return t.$setValidity("charset",-1!==n),n>=0&&n<=o}}}}}).directive("minbytes",function(){return{restrict:"A",require:["?ngModel","^?ngModelOptions"],link:function(e,a,n,r){var t=r[0],l=r[1]&&r[1].$options.getOption("charset")||"utf8";if(t){var o=0;n.$observe("minbytes",function(e){var a=i(e)||0;o=h(a)?-1:a,t.$validate()}),t.$validators.minbytes=function(e,a){if(t.$isEmpty(a))return!0;var n=c(a,l);return t.$setValidity("charset",-1!==n),n>=0&&n>=o}}}}}).filter("translate",function(){return d(o,{$stateful:!0})});var m={gbk:[164,0,167,1,176,1,183,0,215,0,224,1,232,2,236,1,242,1,249,1,252,0,257,0,275,0,283,0,299,0,324,0,328,0,333,0,462,0,464,0,466,0,468,0,470,0,472,0,474,0,476,0,593,0,711,0,713,2,729,0,913,16,931,6,945,16,963,6,1025,0,1040,63,8208,0,8211,3,8216,1,8220,1,8229,1,8240,0,8242,1,8245,0,8251,0,8453,0,8457,0,8470,0,8481,0,8544,11,8560,9,8592,3,8598,3,8712,0,8721,0,8725,0,8730,0,8733,3,8739,0,8741,0,8743,4,8750,0,8756,3,8776,0,8780,0,8786,0,8800,1,8804,3,8814,1,8853,0,8857,0,8869,0,8978,0,9312,9,9332,39,9472,75,9552,35,9601,14,9619,2,9632,1,9650,1,9670,1,9675,0,9678,1,9698,3,9733,1,9737,0,9792,0,9794,0,12288,3,12317,1,12321,8,12353,82,12443,3,12449,85,12540,2,12549,36,12832,9,12849,0,13198,1,13212,2,13217,0,13252,0,13262,0,13265,1,13269,0,19968,20901,59335,1,59413,79,63788,0,63865,0,63893,0,63975,0,63985,0,64012,3,64017,0,64019,1,64031,2,64035,1,64039,2,65072,1,65075,17,65097,9,65108,3,65113,13,65128,3,65504,5],gb18030:[164,0,167,1,176,1,183,0,215,0,224,1,232,2,236,1,242,1,249,1,252,0,257,0,275,0,283,0,299,0,324,0,328,0,333,0,462,0,464,0,466,0,468,0,470,0,472,0,474,0,476,0,505,0,609,0,711,0,713,2,729,0,913,16,931,6,945,16,963,6,1025,0,1105,0,7743,0,8208,0,8211,3,8216,1,8220,1,8229,1,8240,0,8242,1,8251,0,8364,0,8451,0,8453,0,8457,0,8470,0,8481,0,8544,11,8560,9,8598,3,8712,0,8719,0,8721,0,8725,0,8730,0,8733,3,8739,0,8741,0,8750,0,8756,3,8765,0,8776,0,8780,0,8786,0,8800,1,8804,3,8814,1,8857,0,8869,0,8895,0,8978,0,9312,9,9332,39,9472,75,9552,35,9601,14,9632,1,9650,1,9660,1,9670,1,9675,0,9678,1,9698,3,9733,1,9737,0,9794,0,11905,0,11908,0,11912,0,11915,1,11927,0,11943,0,11946,0,11950,0,11958,1,11963,0,11978,0,12272,11,12288,3,12293,18,12317,1,12321,8,12350,0,12443,3,12449,85,12540,2,12549,36,12832,9,12849,0,12963,0,13198,1,13212,2,13252,0,13262,0,13265,1,13269,0,13383,0,13427,0,13726,0,13838,0,13850,0,14702,0,14799,1,14815,0,14963,0,15182,0,15470,0,15584,0,16470,0,16735,0,17324,0,17329,0,17373,0,17622,0,17996,0,18017,0,18211,0,18217,0,18300,0,18759,0,18810,0,18813,0,18818,1,18821,1,18843,0,18847,0,18870,1,19575,0,19731,6,19886,0,19968,20901,57344,1899,59245,89,59337,29,59380,32,59414,2,59422,0,59435,1,59441,1,59451,0,59459,0,59476,1,59492,0,63788,0,63865,0,63893,0,63985,0,64012,3,64017,0,64019,1,64024,0,64031,2,64035,1,64039,2,65072,1,65097,9,65108,3,65113,13,65128,3,65281,93,65504,5]}});