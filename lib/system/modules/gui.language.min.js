define(["require","exports","application"],function(a,e,n){var i=angular.module("gui.language",["ng"]),t=n.uefi,r=angular.forEach,u=angular.injector,l=angular.extend,s=angular.merge,o=Array.prototype.slice,c={},f=null,g={$locale:null,currency:n.currency||"Â¥",locales:n.locales||["zh-cn"],locale:n.locale},d=Number.isNaN||function(e){return e!=e};function v(t){var r=this.locale;$.dynamics=$.dynamics||{$$buf:{},put:function(e){e&&(e=e.substr(0,e.lastIndexOf("/")),this.$$buf[e]=!0)},has:function(e){return e=e.substr(0,e.lastIndexOf("/")),!!this.$$buf[e]}};var e=v.languages=v.languages||{},l=e[r]=e[r]||{},o=n.routes.concat(n.layout);o=(o=o.concat(n.languages)).filter(function(e){var a=e.language[r];return a&&!l[a]&&(!e.extras.dynamic||$.dynamics.has(a))}).map(function(e){return e.language[r]});var c="lib/angular.js/i18n/angular-locale_LOCALE.js";o.unshift(c.replace(/LOCALE/,r)),f&&f.$broadcast("$localeChangeStart",r),a(o,function(){for(var e=0;e<o.length;e++){var a,n=o[e];e?(l[n]=!0,o[e]=[n,arguments[e]]):(a=l[n]=l[n]||u(["ngLocale"]).get("$locale"),o[e]=[c,arguments[e]],g.$locale&&g.$locale.id!==a.id&&s(g.$locale,a))}$.bind({locale:r})(o),t&&t(i),f&&f.$broadcast("$localeChangeSuccess",r)})}function $(){var n=c[this.locale]=c[this.locale]||{};r(o.apply(arguments),function(e){r(e,function(e){$.dynamics.put(e[0]),r(e[1],function(e,a){n[a.toLowerCase()]=e})})})}function y(e){if(e=(e||Modernizr.localstorage&&localStorage["system.locale"]||navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage||g.locale||"zh-cn").toLowerCase(),-1==g.locales.indexOf(e)&&(e="zh-cn"),-1!==g.locales.indexOf(e)&&Modernizr.localstorage)try{localStorage["system.locale"]=e}catch(e){}return e}function b(e){if(!e)return"";e=e.trim().toLowerCase();var a=(c[g.locale]||{})[e];if(!a)return"TODO: Translate `"+e+"` in `"+g.locale+"`";var t=o.call(arguments,1);return t.length?a.replace(/\{(\d+)\}/g,function(e,a){var n=t[0|a];return void 0!==n?n:e}):a}function p(e,a){var n=0;switch(a){case"gbk":case"gb18030":e=Array.from(e);for(var t=0;t<e.length;t++){if((u=e[t].codePointAt(0))<128)n+=1;else{for(var r=m[a],l=!1,o=0;o<r.length;o+=2){var c=r[o],i=c+r[o+1];if(l=c<=u&&u<=i)break}if(l)n+=2;else{if(r!==m.gb18030)return-1;if(1587600<u)return-1;n+=4}}}break;case"utf8":e=Array.from(e);for(var u,t=0;t<e.length;t++){if((u=e[t].codePointAt(0))<128)n+=1;else if(u<2048)n+=2;else if(u<65536)n+=3;else{if(!(u<1114112))return-1;n+=4}}break;default:return-1}return n}function h(e){return parseInt(e,10)}g.locale=y(),l(e,{name:i.name,module:v.bind({locale:g.locale})}),["locale","locales","currency"].forEach(function(e){delete n[e]}),i.config(["$provide",function(a){g.$locale||(t.progress("Application","setup gui.language"),a.decorator("currencyFilter",["$delegate",function(a){return l(function(){var e=o.apply(arguments);return e[1]&&"$system$"!==e[1]||(e[1]=g.currency),a.apply(a,e)},{$stateful:!0})}]),["date","number"].forEach(function(e){a.decorator(e+"Filter",["$delegate",function(e){return l(e,{$stateful:!0})}])}))}]).factory("languageService",["$locale",function(e){return g.$locale=e,{loadLanguage:$.bind(g),translate:b.bind({}),getLocale:function(){return g.locale},getLocales:function(){return[].concat(g.locales)},setLocale:function(e){y()!==e&&(e=y(e.toLowerCase()),v.bind({locale:e})(function(){g.locale=e}))}}}]).directive("maxbytes",function(){return{restrict:"A",require:["?ngModel","^?ngModelOptions"],link:function(e,a,n,t){var r,l=t[0],o=t[1]&&t[1].$options.getOption("charset")||"utf8";l&&(r=-1,n.$observe("maxbytes",function(e){var a=h(e)||0;r=d(a)?-1:a,l.$validate()}),l.$validators.maxbytes=function(e,a){if(r<0||l.$isEmpty(a))return!0;var n=p(a,o);return l.$setValidity("charset",-1!==n),0<=n&&n<=r})}}}).directive("minbytes",function(){return{restrict:"A",require:["?ngModel","^?ngModelOptions"],link:function(e,a,n,t){var r,l=t[0],o=t[1]&&t[1].$options.getOption("charset")||"utf8";l&&(r=0,n.$observe("minbytes",function(e){var a=h(e)||0;r=d(a)?-1:a,l.$validate()}),l.$validators.minbytes=function(e,a){if(l.$isEmpty(a))return!0;var n=p(a,o);return l.$setValidity("charset",-1!==n),0<=n&&r<=n})}}}).filter("translate",function(){return l(b,{$stateful:!0})});var m={gbk:[164,0,167,1,176,1,183,0,215,0,224,1,232,2,236,1,242,1,249,1,252,0,257,0,275,0,283,0,299,0,324,0,328,0,333,0,462,0,464,0,466,0,468,0,470,0,472,0,474,0,476,0,593,0,711,0,713,2,729,0,913,16,931,6,945,16,963,6,1025,0,1040,63,8208,0,8211,3,8216,1,8220,1,8229,1,8240,0,8242,1,8245,0,8251,0,8453,0,8457,0,8470,0,8481,0,8544,11,8560,9,8592,3,8598,3,8712,0,8721,0,8725,0,8730,0,8733,3,8739,0,8741,0,8743,4,8750,0,8756,3,8776,0,8780,0,8786,0,8800,1,8804,3,8814,1,8853,0,8857,0,8869,0,8978,0,9312,9,9332,39,9472,75,9552,35,9601,14,9619,2,9632,1,9650,1,9670,1,9675,0,9678,1,9698,3,9733,1,9737,0,9792,0,9794,0,12288,3,12317,1,12321,8,12353,82,12443,3,12449,85,12540,2,12549,36,12832,9,12849,0,13198,1,13212,2,13217,0,13252,0,13262,0,13265,1,13269,0,19968,20901,59335,1,59413,79,63788,0,63865,0,63893,0,63975,0,63985,0,64012,3,64017,0,64019,1,64031,2,64035,1,64039,2,65072,1,65075,17,65097,9,65108,3,65113,13,65128,3,65504,5],gb18030:[164,0,167,1,176,1,183,0,215,0,224,1,232,2,236,1,242,1,249,1,252,0,257,0,275,0,283,0,299,0,324,0,328,0,333,0,462,0,464,0,466,0,468,0,470,0,472,0,474,0,476,0,505,0,609,0,711,0,713,2,729,0,913,16,931,6,945,16,963,6,1025,0,1105,0,7743,0,8208,0,8211,3,8216,1,8220,1,8229,1,8240,0,8242,1,8251,0,8364,0,8451,0,8453,0,8457,0,8470,0,8481,0,8544,11,8560,9,8598,3,8712,0,8719,0,8721,0,8725,0,8730,0,8733,3,8739,0,8741,0,8750,0,8756,3,8765,0,8776,0,8780,0,8786,0,8800,1,8804,3,8814,1,8857,0,8869,0,8895,0,8978,0,9312,9,9332,39,9472,75,9552,35,9601,14,9632,1,9650,1,9660,1,9670,1,9675,0,9678,1,9698,3,9733,1,9737,0,9794,0,11905,0,11908,0,11912,0,11915,1,11927,0,11943,0,11946,0,11950,0,11958,1,11963,0,11978,0,12272,11,12288,3,12293,18,12317,1,12321,8,12350,0,12443,3,12449,85,12540,2,12549,36,12832,9,12849,0,12963,0,13198,1,13212,2,13252,0,13262,0,13265,1,13269,0,13383,0,13427,0,13726,0,13838,0,13850,0,14702,0,14799,1,14815,0,14963,0,15182,0,15470,0,15584,0,16470,0,16735,0,17324,0,17329,0,17373,0,17622,0,17996,0,18017,0,18211,0,18217,0,18300,0,18759,0,18810,0,18813,0,18818,1,18821,1,18843,0,18847,0,18870,1,19575,0,19731,6,19886,0,19968,20901,57344,1899,59245,89,59337,29,59380,32,59414,2,59422,0,59435,1,59441,1,59451,0,59459,0,59476,1,59492,0,63788,0,63865,0,63893,0,63985,0,64012,3,64017,0,64019,1,64024,0,64031,2,64035,1,64039,2,65072,1,65097,9,65108,3,65113,13,65128,3,65281,93,65504,5]}});