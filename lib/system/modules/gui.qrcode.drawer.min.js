define(["require","exports"],function(r,e){function t(r,e,t,i,a,n,o,l){if(void 0===l&&(l=!0),void 0===n&&(n=5),"number"==typeof n)n={tl:n,tr:n,br:n,bl:n};else{var d={tl:0,tr:0,br:0,bl:0};for(var f in d)n[f]=n[f]||d[f]}r.beginPath(),r.moveTo(e+n.tl,t),r.lineTo(e+i-n.tr,t),r.quadraticCurveTo(e+i,t,e+i,t+n.tr),r.lineTo(e+i,t+a-n.br),r.quadraticCurveTo(e+i,t+a,e+i-n.br,t+a),r.lineTo(e+n.bl,t+a),r.quadraticCurveTo(e,t+a,e,t+a-n.bl),r.lineTo(e,t+n.tl),r.quadraticCurveTo(e,t,e+n.tl,t),r.closePath(),o&&r.fill(),l&&r.stroke()}function i(r,e,t){var i=t.scale||4,a=t.margin||4,n=e.length,o=(n+2*a)*i;r.attr("width",o).attr("height",o),r.css("margin-left","calc(50% - "+o/2+"px)");var l=r[0].getContext("2d");l.fillStyle="#ffffff",l.fillRect(0,0,o,o);var d=t.color.dark||"#000000";l.fillStyle=d;for(var f=0;f<n;f++)for(var s=0;s<n;s++)if(e[f][s]){var c=(f+a)*i,v=(s+a)*i;l.fillRect(c,v,i,i)}}function a(r,e,t,i){var a=t.scale||4,n=t.margin||4,o=e.length,l=(o+2*n)*a,d=t.color.dark||"#000000";r.width(l).height(l),r.css("margin-left","calc(50% - "+l/2+"px)");for(var f="",s=0;s<o;s+=1)for(var c=0;c<o;c+=1)e[s][c]&&(f+="M"+(c+n)*a+" "+(s+n)*a+"h"+a+"v"+a+"h-"+a+"z");var v=['<svg xmlns="http://www.w3.org/2000/svg" viewBox="'+[0,0,l,l].join(" ")+'">','<path d="'+f+'" fill="'+d+'"/>',"</svg>"];r.html(v.join("\n"))}function n(r,e,t,i){var a=t.scale||4,n=t.margin||4,o=e.length,l=(o+2*n)*a,d=t.color.dark||"#000000";r.width(l).height(l),r.css("margin-left","calc(50% - "+l/2+"px)");for(var f="qrs"+(new Date).getTime(),s="<style>."+f+"{position:absolute;background:"+d+";width:"+a+"px;height:"+a+"px;}</style>",c=0;c<o;c++)for(var v=0;v<o;v++)e[c][v]&&(s+="<div class='"+f+"' style='left:"+(c+n)*a+"px;top:"+(v+n)*a+"px;'></div>");r.html(s)}e.ngQrcode=function(r){return{replace:!0,restrict:"A",require:"ngModel",template:Modernizr.canvas?"<canvas ng-hide></canvas>":"<div ng-hide style='position:relative;background:#ffffff;'></div>",link:function(e,o,l,d){var f=new Image,s=!!l.ngBrand;s&&(f.src=l.ngBrand,angular.element(f).on("load",function(){f.ready=!0,f.$render&&f.$render()})),d.$render=function(){var e=d.$modelValue;if(!e||d.$isEmpty(e.data))return f.$render=null,o.addClass("ng-hide");var l=angular.merge({errorCorrectionLevel:"Q",color:{dark:"#00007f",light:"#ffffff"}},e.options),c=r(e,l);Modernizr.canvas?(i(o,c,l),(f.$render=function(){if(s&&!f.ready||o.removeClass("ng-hide"),f.ready){var r=o[0].getContext("2d"),e=(o.width()-48)/2;r.fillStyle="#ffffff",r.strokeStyle="#00007f",r.lineWidth=2,t(r,e,e,48,48,5,!0,!0),r.clip(),r.drawImage(f,e,e,48,48)}})()):((Modernizr.svg?a:n)(o,c,l),(f.$render=function(){if(s&&!f.ready||o.removeClass("ng-hide"),f.ready){var r=(o.width()-48)/2;o.css({position:"relative"}).append(angular.element(f).css({top:r,left:r,width:48,height:48,"border-width":2,"border-style":"solid","-webkit-border-radius":5,"-moz-border-radius":5,"border-radius":5,"background-color":"#ffffff","border-color":"#00007f",position:"absolute"}))}})())}}}}});